{% extends "base.html" %}
{% load static %}  

{% block title %}
    Objekt list
{% endblock %}

<!-- 放子分頁的 css -->
{% block extra_css %} 
    {{ block.super }}  <!-- 繼承母版的 css 但不要覆蓋 -->
    <link rel="stylesheet" href="{% static 'list.css' %}">
{% endblock %}


{% block content %}

    <!-- filter -->
    <div class="filter-bar">
        <form method="GET">
            {{ objektFilter.form.as_table }}
        </form>
    </div>

    <!-- sort -->
    <div class="sort-bar">
        <form method="GET" id="sort-form">
            <!-- 保留現有的 filter 參數 -->
            {% for field in objektFilter.form %}
                {% if field.value %}
                    <input type="hidden" name="{{ field.name }}" value="{{ field.value }}">
                {% endif %}
            {% endfor %}
            
            <label for="sort-select"> 主要排序： </label>
            <select id="sort-select" name="sort_by" onchange="this.form.submit()">
                <option value="season__name" {% if request.GET.sort_by == 'season__name' %}selected{% endif %}> Season </option>
                <option value="member__name" {% if request.GET.sort_by == 'member__name' %}selected{% endif %}> Member </option>
                <option value="collection__name" {% if request.GET.sort_by == 'collection__name' %}selected{% endif %}> Collection </option>
            </select>
            
            <label for="sort-secondary"> 次要排序： </label>
            <select id="sort-secondary" name="sort_secondary" onchange="this.form.submit()">
                <option value="" {% if not request.GET.sort_secondary %}selected{% endif %}> -- 無 -- </option>
                <option value="season__name" {% if request.GET.sort_secondary == 'season__name' %}selected{% endif %}> Season </option>
                <option value="member__name" {% if request.GET.sort_secondary == 'member__name' %}selected{% endif %}> Member </option>
                <option value="collection__name" {% if request.GET.sort_secondary == 'collection__name' %}selected{% endif %}> Collection </option>
            </select>
            
            <button type="submit" name="order" value="{% if request.GET.order == 'desc' %}asc{% else %}desc{% endif %}">
                {% if request.GET.order == 'desc' %} Ascending ↑ {% else %}  Descending ↓ {% endif %}
            </button>
            <!-- 保留其他 sort 參數 -->
             <input type="hidden" name="sort_by" value="{{ request.GET.sort_by }}">
             <input type="hidden" name="sort_secondary" value="{{ request.GET.sort_secondary }}">
        </form>
    </div>

    <!-- objekt stats info -->
    <div class="info-area">
        <p>共 {{ cards | length }} 張卡</p>
    </div>

    <!-- grid display objekts -->
    <div class="display-all-objekt">
        {% for card in cards %}
            <div>
                {% if card.image_uri %}
                    <img src="{{ card.image_uri }}" alt="{{ card }}" style="max-height: 150px;>
                {% endif %}
                <p> {{ card }} </p>
            </div>
        {% endfor %}
    </div>

{% endblock %}